<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="description" content="Brave Frontier - For Unit Art Grabbing - A community effort by Brave Frontier PROs" />
    <meta name="author" content="Sam GreenPuck" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Brave Frontier - For Unit Art Grabbing - by Brave Frontier PROs</title>
    <link rel="shortcut icon" href="https://googledrive.com/host/0B4hJr8BXxvFZZVVOZWswdnlnYTg/iconavatar128.png" />
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Quicksand|Raleway:600,400' rel='stylesheet' type='text/css'>
    <link href="//touchandswipe.github.io/bravefrontier/css/sitecommon.css" rel="stylesheet">
<!-- Custom CSS -->
<style type="text/css">
    .clear {clear:both;}
    .bd {
        font-weight:bold;
        background:#EEEEEE;
        text-transform:uppercase;
    }
    .upper {
        text-transform:uppercase;
    }
    .reduceIMG { width:25%;height:25%; }
</style>
<!-- START JSON Code-->
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script src="//touchandswipe.github.io/bravefrontier/js/lz-string-1.3.3-min.js"></script>
</head>

<!-- MAIN BODY CONTENT -->
<body>
<div class="container-fluid" id="bfp_mast"></div>
<!-- Main Body Space-->
<div class="container-fluid" style="margin:0px;padding:5px;">
<div class="alert alert-warning alert-dismissible" role="alert">
<button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
<i class="fa fa-heart-o fa-lg"></i> This is created to ease the retrieval of artwork for Brave Frontier. Not for hacking / modding purposes. Only IDs existing can be searched for using Unit IDs. Otherwise use the filename query. Usually units file IDs consist of 6 numerical digits beginning with 1 to 6 for element and Ending with rarity 1-6 as well. Exclusive units begin with 8 on global and 9 for korea with 2nd digit denoting element instead. E.g. Global Vortex Exclusive = 840044 or 81045. Korea Exclusive = 911103 or 961105. Use file references for monster sprites 0001 onwards for normal monsters. raid0X onwards and (raid boss parts e.g. _body or _body_b) options after. GQ0X for Grand Quest bosses. for maps use e.g. 001_01 or 004_04. For unit chars, use e.g. navi_chara35_0.
</div>

<h3>Select Brave Frontier Server</h3>
<div class="col-xs-12 col-sm-12 col-md-12">
  <select class="form-control" id="serverSelect">
    <option value="gl" selected="selected">Global</option>
    <option value="jp">Japan</option>
    <option value="kr">Korea</option>
    <option value="eu">Europe</option>
  </select>
</div>

<div class="col-xs-12 col-md-12" style="margin-top:5px;">
	<button type="button" class="btn btn-success btn-xs" id="refreshData"><i class="fa fa-cloud-download"></i> Sync latest data</button> <b>Last updated: </b><span class="text-danger" id="lastModDate">TBD</span>
</div>

<div class="clear">&nbsp;</div>
<div class="col-xs-12 col-sm-12 col-md-12">
<!--Search-->
  <div class="input-group" style="margin-bottom:5px;">
          <span class="input-group-btn">
          <button class="btn btn-primary" type="button" id="idBtn">Retrieve by UNIT ID</button></span>
          <input type="search" placeholder="e.g. 100 or 500" class="form-control" id="idBox">
  </div>
  <div class="input-group">
          <span class="input-group-btn">
          <button class="btn btn-primary" type="button" id="pathBtn">Retrieve by filename</button></span>
          <input type="search" placeholder="e.g. 10015" class="form-control" id="pathBox">
  </div>
</div>

<div class="col-xs-12 col-sm-12 col-md-12">
  <img src="" id="imgThumb"/>
  <img src="" id="imgFull" class="reduceIMG"/>
  <img src="" id="imgSprite" class="reduceIMG"/>
  <img src="" id="imgVortex"/>
  <img src="" id="imgGacha"/>
  <img src="" id="imgMonster" class="reduceIMG"/>
  <img src="" id="imgMap" class="reduceIMG"/>
  <img src="" id="imgEvent" class="reduceIMG"/>
  <p><a href="" id="linkAnimate"></a></p>
  <p><a href="" id="linkCGG"></a></p>
</div>
</div> <!-- /container -->

<!-- Modal for Progress-->
<div class="modal fade" id="progressModal" tabindex="-1" role="dialog" aria-labelledby="myprogressModal" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-body">
	<div class="text-center">
	    <h3 class="text-primary"><b>Chasing wild koalas</b></h3>
	    <i class="fa fa-spinner fa-spin fa-5x"></i>
	    <h4 class="text-primary">A moment please ...</h4>
	    <h5>(Note: This can take a while depending on connection speed ...)</h5>
	</div>
      </div>
    </div>
  </div>
</div>

<!-- Alert Modal -->
<div class="modal fade" id="alertmodal" tabindex="-1" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
    <div class="modal-header"><button type="button" class="close" data-dismiss="modal">&times;</button><h3 class="modal-title text-danger"><i class="fa fa-fire"></i> Lugina Grumbles Grumbles</h3></div>
      <div class="modal-body">
	<div id="alertSpace" class="alert">
	<i class="fa fa-fire-extinguisher"></i> <strong>New data available for sync</strong>
	You can sync now or later at any time. Do you wish to sync now? <div class="text-right"><button type="button" class="btn btn-success" id="syncNewBtn"><i class="fa fa-cloud-download"></i> Sync Now</button> <button type="button" class="btn btn-default" data-dismiss="modal" id="syncCancel">Cancel</button></div>
	</div>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
bfserver={"gl":"//2.cdn.bravefrontier.gumi.sg/content/","jp":"//v2.cdn.android.brave.a-lim.jp/","kr":"//d1dwwuvait5r4t.cloudfront.net/bf/v1.3.0/","eu":"//static.bravefrontier.gumi-europe.net/content/"};
fPrefix={"full":"unit/img/unit_ills_full_","thumb":"unit/img/unit_ills_thum_","sprite":"unit/img/unit_anime_","vortex":"dungeon/sp_quest_banner_","gacha":"gacha/gacha_rare_bg_img_","animate":"unit/cgs/unit_atk_cgs_","cgg":"unit/cgg/unit_cgg_","monster":"monster/img/monster_anime_","map":"raid/raid_map/raid_map","event":"event/"};
fSuffix=".png";
coreDat={};
serverGuide="";
jsonURL="";

function convertID(guideid) {
  var idFound=false;
  var convID=0;
    $.each( coreDat, function( unitKey, valObj ) {
        var exportSTR="";
        if (valObj.guide_id==guideid)
            idFound=true
        else
            idFound=false
        if (idFound) {
          convID=valObj.id;
          return false;
        }
    })
  return convID;
}

function grabIMG() {
  var imgID=convertID($("#idBox").val());
  if (imgID!=0)
  	$("#pathBox").val(imgID);
  var urlThumb=bfserver[$("#serverSelect").val()]+fPrefix.thumb+imgID+fSuffix;
  var urlFull=bfserver[$("#serverSelect").val()]+fPrefix.full+imgID+fSuffix;
  var urlSprite=bfserver[$("#serverSelect").val()]+fPrefix.sprite+imgID+fSuffix;
  var urlAnimate=bfserver[$("#serverSelect").val()]+fPrefix.animate+imgID+".csv";
  var urlCGG=bfserver[$("#serverSelect").val()]+fPrefix.cgg+imgID+".csv";
  $("#imgThumb").attr("src",urlThumb);
  $("#imgFull").attr("src",urlFull);
  $("#imgSprite").attr("src",urlSprite);
  $("#imgVortex").attr("src","");
  $("#imgGacha").attr("src","");
  $("#imgMonster").attr("src","");
  $("#linkAnimate").attr("href",urlAnimate);
  $("#linkAnimate").html("Download ATK Spritesheet (CSV)");
  $("#linkCGG").attr("href",urlCGG);
  $("#linkCGG").html("Download CGG Spritesheet (CSV)");
}

function grabIMG2() {
  var imgID=$("#pathBox").val();
  var urlThumb=bfserver[$("#serverSelect").val()]+fPrefix.thumb+imgID+fSuffix;
  var urlFull=bfserver[$("#serverSelect").val()]+fPrefix.full+imgID+fSuffix;
  var urlSprite=bfserver[$("#serverSelect").val()]+fPrefix.sprite+imgID+fSuffix;
  var urlVortex=bfserver[$("#serverSelect").val()]+fPrefix.vortex+imgID+fSuffix;
  var urlGacha=bfserver[$("#serverSelect").val()]+fPrefix.gacha+imgID+fSuffix;
  var urlMonster=bfserver[$("#serverSelect").val()]+fPrefix.monster+imgID+fSuffix;
  var urlMap=bfserver[$("#serverSelect").val()]+fPrefix.map+imgID+".jpg";
  var urlEvent=bfserver[$("#serverSelect").val()]+fPrefix.event+imgID+".png";
  var urlAnimate=bfserver[$("#serverSelect").val()]+fPrefix.animate+imgID+".csv";
  var urlCGG=bfserver[$("#serverSelect").val()]+fPrefix.cgg+imgID+".csv";
  $("#imgThumb").attr("src",urlThumb);
  $("#imgFull").attr("src",urlFull);
  $("#imgSprite").attr("src",urlSprite);
  $("#imgVortex").attr("src",urlVortex);
  $("#imgGacha").attr("src",urlGacha);
  $("#imgMonster").attr("src",urlMonster);
  $("#imgMap").attr("src",urlMap);
  $("#imgEvent").attr("src",urlEvent);
  $("#linkAnimate").attr("href",urlAnimate);
  $("#linkAnimate").html("Download ATK Spritesheet (CSV)");
  $("#linkCGG").attr("href",urlAnimate);
  $("#linkCGG").html("Download CGG Spritesheet (CSV)");
}

/*check valid json*/
function isValidJSON(str) {
    try {
        JSON.parse(str);
    } catch (e) {
        return false;
    }
    return true;
}

/*Check filedate*/
function checkUpdate(fileURL,localDate) {
    $.ajax({
    	type: "Head",
        dataType: "json",
        contentType: "text/plain; charset=UTF-8",
        url: fileURL,
        success: function(data, textStatus, request) {
    		lastModified = request.getResponseHeader("Last-Modified");
    		if (Date.parse(lastModified) > Date.parse(localDate))
    			$("#alertmodal").modal("show")
 	}
    })
}

/*Reset Local Storage*/
function resetLocalData(serverStr, corrupted) {
	/*LocalStorage Delete and Refresh*/
	if (corrupted)
		alert("Corrupted data detected or Data structure has changed. Proceed to Fix.");
	localStorage.removeItem(serverStr);
	localStorage.removeItem(serverStr+"date");
	history.pushState(null, null, location.pathname);
	location.reload(true);
}

function serverCheckRun() {
/*Determine server data*/
jsonURL=($('#serverSelect').val()=='gl')?"//touchandswipe.github.io/bravefrontier_data/info.json":"//touchandswipe.github.io/bravefrontier_data/jp/info.json";
serverGuide=($('#serverSelect').val()=='gl')?"skillsguideglobal":"skillsguidejapan";

  /*LocalStorage Retreival and storage*/
    if (localStorage.getItem(serverGuide) != null) {
	guideData=LZString.decompressFromUTF16(localStorage.getItem(serverGuide));
	if (isValidJSON(guideData)) {
		coreDat=JSON.parse(guideData);
		$('#lastModDate').text("Using local cache - "+localStorage.getItem(serverGuide+"date"));
		checkUpdate(jsonURL,localStorage.getItem(serverGuide+"date"));
	} else 
		resetLocalData(serverGuide,true)
    } else {
	    /*Init loader*/
	    $('#progressModal').modal({
	    	keyboard:false,
	    	backdrop:'static',
	    	toggle:true
	    })
	    $.ajax({
	        dataType: "json",
	        contentType: "text/plain; charset=UTF-8",
	        url: jsonURL,
	        success: function(data, textStatus, request){
	    		lastModified = request.getResponseHeader("Last-Modified");
	    		/*Save in local storage*/
			localStorage.setItem(serverGuide,LZString.compressToUTF16(JSON.stringify(data)));
			localStorage.setItem(serverGuide+"date",lastModified);
			$('#lastModDate').text("Server data - "+lastModified);
	    		coreDat=data;
	    		$('#progressModal').modal('hide');
	 	}
	    })
    }
}

$(document).ready( function(e) {
/*load masthead shared*/
$('#bfp_mast').load('//touchandswipe.github.io/bravefrontier/common/header.html');
serverCheckRun();

/*On server change*/
$(document).on("change", '#serverSelect', function(e){
  serverCheckRun();
})

/*Sync New Button*/
$(document).on("click", '#syncNewBtn', function(e){
  /*Resets data*/
  resetLocalData(serverGuide,false)
})

/*Refresh data*/
$(document).on("click", '#refreshData', function(e){
    /*Init loader*/
    $('#progressModal').modal({
    	keyboard:false,
    	backdrop:'static',
    	toggle:true
    });
  resetLocalData(serverGuide,false)
})
  
/*Binds Enter KEY to BOX*/
$( "#idBox" ).keypress( function( event ) {
  if ( event.which == 13 ) {
    grabIMG()
  }
})

/*Binds Enter KEY to BOX*/
$( "#pathBox" ).keypress( function( event ) {
  if ( event.which == 13 ) {
    grabIMG2()
  }
})

$(document).on("click", '#idBtn', function(e){
  grabIMG()
})

$(document).on("click", '#pathBtn', function(e){
  grabIMG2()
})
  
}) /*End DocReady*/
</script>

<!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    
      ga('create', 'UA-48617906-1', 'tumblr.com');
      ga('send', 'pageview');
    </script>
<!--Chatroom-->
<script id="sid0020000056109341636">(function() {function async_load(){s.id="cid0020000056109341636";s.src='http://st.chatango.com/js/gz/emb.js';s.style.cssText="width:400px;height:500px;";s.async=true;s.text='{"handle":"bravefrontierpros","arch":"js","styles":{"a":"cc33cc","b":51,"c":"ffffff","d":"ffffff","e":"ffffff","g":"202020","k":"cc33cc","l":"77eecc","m":"cc66cc","q":"cc33cc","r":51,"t":0,"pos":"bl","cv":1,"cvfnt":"\'Helvetica Neue\', Helvetica, Arial, sans-serif, sans-serif","cvfntsz":"10pt","cvfntw":"bold","cvbg":"cc66cc","cvw":75,"cvh":40,"sbc":"66ddbb","surl":0,"cnrs":"0.35"}}';var ss = document.getElementsByTagName('script');for (var i=0, l=ss.length; i < l; i++){if (ss[i].id=='sid0020000056109341636'){ss[i].id +='_';ss[i].parentNode.insertBefore(s, ss[i]);break;}}}var s=document.createElement('script');if (s.async==undefined){if (window.addEventListener) {addEventListener('load',async_load,false);}else if (window.attachEvent) {attachEvent('onload',async_load);}}else {async_load();}})();</script>
</body>
</html>
